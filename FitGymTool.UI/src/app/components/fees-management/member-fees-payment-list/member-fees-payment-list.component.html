<div class="member-fees-payment-card card shadow-m border-0 bg-dark">
  <div class="card-body d-flex flex-column">
    <h1 class="card-title">{{ memberFeesConstants.Header }}</h1>
    <h6 class="card-subtitle mb-4">{{ memberFeesConstants.SubHeader }}</h6>
  </div>
  <div class="member-fees-payment-data-table">
    <p-table
      #feesPaymentListTable
      [value]="currentMemberFeesData()"
      [rows]="10"
      [paginator]="true"
      [columns]="columnHeaders"
      ngClass="fees-payment-table"
      showGridlines
      stripedRows
    >
      <ng-template pTemplate="header" let-columns>
        <tr>
          <th *ngFor="let col of columns">
            {{ col.header }}
          </th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-rowData let-columns="columns">
        <tr>
          <td *ngFor="let col of columns">
            <ng-container
              *ngIf="
                col.field === 'dueDate' || col.field === 'lastPaymentDate';
                else checkButtonCell
              "
            >
              {{ rowData[col.field] | date : "d MMM yyyy" }}
            </ng-container>

            <ng-template #checkButtonCell>
              <ng-container *ngIf="col.field === ''; else normalCell">
                <p-button
                  icon="pi pi-receipt"
                  [style]="{ width: '100%', height: '5vh', padding: '10px' }"
                  (onClick)="handleMemberClick(rowData.memberEmail)"
                  >Details&nbsp;
                </p-button>
              </ng-container>
            </ng-template>

            <ng-template #normalCell>
              <ng-container *ngIf="col.field === 'feesPaymentStatus'">
                <span
                  [class]="getPaymentStatusClass(rowData[col.field])"
                  class="badge px-2 py-1"
                >
                  {{ rowData[col.field] }}
                </span>
              </ng-container>
              <ng-container *ngIf="col.field !== 'feesPaymentStatus'">
                {{ rowData[col.field] }}
              </ng-container>
            </ng-template>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td [attr.colspan]="columnHeaders.length" class="text-center py-4">
            <div class="empty-state">
              <i
                class="pi pi-search"
                style="font-size: 2rem; color: #6c757d"
              ></i>
              <p class="mt-2 mb-0">No results found</p>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>

<app-member-fees-payment-history
  [memberEmail]="selectedMember"
></app-member-fees-payment-history>
