<p-dialog
  [header]="'Payment Details'"
  [modal]="true"
  [(visible)]="showDialog"
  [style]="{ width: '80rem' }"
  [closable]="false"
  (onShow)="onDialogShow()"
  (onHide)="onDialogHide()"
>
  <div class="payment-history-table-wrapper">
    <p-table
      #paymentHistoryTable
      [value]="currentMemberPaymentHistory()"
      [rows]="10"
      [paginator]="true"
      [columns]="columnHeaders"
      ngClass="payment-history-table"
      showGridlines
      stripedRows
      [scrollable]="true"
      scrollHeight="400px"
    >
      <ng-template pTemplate="header" let-columns>
        <tr>
          <th *ngFor="let col of columns" class="text-center">
            {{ col.header }}
          </th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-rowData let-columns="columns">
        <tr>
          <td *ngFor="let col of columns" class="text-center">
            <ng-container
              *ngIf="
                col.field === 'fromDate' || col.field === 'toDate';
                else checkAmountField
              "
            >
              {{ rowData[col.field] | date : "d MMM yyyy" }}
            </ng-container>

            <ng-template #checkAmountField>
              <ng-container *ngIf="col.field === 'amount'; else normalCell">
                <span class="fw-bold text-success">
                  â‚¹{{ rowData[col.field] | number : "1.2-2" }}
                </span>
              </ng-container>

              <ng-template #normalCell>
                <ng-container *ngIf="col.field === 'feesPaymentStatus'">
                  <span
                    [class]="getPaymentStatusClass(rowData[col.field])"
                    class="badge px-2 py-1"
                  >
                    {{ rowData[col.field] }}
                  </span>
                </ng-container>
                <ng-container *ngIf="col.field !== 'feesPaymentStatus'">
                  {{ rowData[col.field] }}
                </ng-container>
              </ng-template>
            </ng-template>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td [attr.colspan]="columnHeaders.length" class="text-center py-5">
            <div class="empty-state">
              <i
                class="pi pi-receipt"
                style="font-size: 3rem; color: #6c757d"
              ></i>
              <p class="mt-3 mb-0 fs-5">No payment history found</p>
              <p class="text-muted">This member has no payment records yet.</p>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <div class="form-actions">
    <p-button
      label="Close"
      severity="danger"
      type="button"
      variant="outlined"
      (onClick)="closeDialog()"
    >
    </p-button>
  </div>
</p-dialog>
